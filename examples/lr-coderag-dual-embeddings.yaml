name: lr-coderag
version: 2.0.0
description: Generated RAG framework for code with dual embeddings
neo4j:
  uri: ${NEO4J_URI}
  database: neo4j
  username: ${NEO4J_USER}
  password: ${NEO4J_PASSWORD}

entities:
  - name: Scope
    description: Code scope with dual embeddings (signature + source)
    searchable_fields:
      - name: signature
        type: string
        description: Function/class signature
      - name: type
        type: string
        description: Type of scope (function, class, etc.)
      - name: file
        type: string
        description: File path
      - name: uuid
        type: string
        description: Unique identifier
      - name: name
        type: string
        description: Scope name

    # NEW: Multiple vector indexes
    vector_indexes:
      - name: scopeEmbeddingsSignature
        field: embedding_signature
        source_field: signature
        dimension: 768
        similarity: cosine
        provider: vertex
        model: text-embedding-004

      - name: scopeEmbeddingsSource
        field: embedding_source
        source_field: source
        dimension: 768
        similarity: cosine
        provider: vertex
        model: text-embedding-004

    relationships:
      - type: DEFINED_IN
        direction: outgoing
        target: File
        description: Scope DEFINED_IN File
      - type: CONSUMES
        direction: outgoing
        target: Scope
        description: Scope CONSUMES Scope
        enrich: true                  # Auto-enrich with CONSUMES relationships
        enrich_field: consumes        # Field name in results
      - type: CONSUMED_BY
        direction: outgoing
        target: Scope
        description: Scope CONSUMED_BY Scope
      - type: USES_LIBRARY
        direction: outgoing
        target: ExternalLibrary
        description: Scope USES_LIBRARY ExternalLibrary

  - name: File
    description: Source code file
    searchable_fields:
      - name: name
        type: string
        description: File name
    relationships:
      - type: IN_DIRECTORY
        direction: outgoing
        target: Directory
        description: File IN_DIRECTORY Directory

  - name: ExternalLibrary
    description: External library dependency
    searchable_fields:
      - name: name
        type: string
        description: Library name

  - name: Directory
    description: Directory in project
    searchable_fields: []

reranking:
  strategies:
    - name: topology-centrality
      type: builtin
      description: Rank by graph centrality (importance)
      algorithm: pagerank

    - name: code-quality
      type: builtin
      description: Prefer well-documented, concise code

    - name: recency
      type: builtin
      description: Prefer recent items
